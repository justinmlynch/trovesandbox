- show_all ||= false
- hide_password ||= false

= simple_form_for resource, as: resource_name, url: registration_path(resource_name) do |f|
  %input{ style: 'display:none', type: 'text', name: 'fakeusernameremembered' } 
  %input{ style: 'display:none', type: 'password', name: 'fakepasswordremembered' } 
  = f.input_field :first_name,       required: true, placeholder: 'First',    type: 'text',     autocomplete: 'off', class: 'form-control tl'
  = f.input_field :last_name,        required: true, placeholder: 'Last',     type: 'text',     autocomplete: 'off', class: 'form-control tr' 
  / = f.input_field :username,        required: true, placeholder: 'Username', type: 'password', autocomplete: 'off', class: 'form-control b' 
  = f.input_field :email,           required: true, placeholder: 'Email',    type: 'text',     autocomplete: 'off', class: 'form-control m', spellcheck: 'false'
  = f.input_field :password,        required: true, placeholder: 'Password', type: 'password', autocomplete: 'off', class: 'form-control b' 
  / = f.input_field :password_confirm, required: true, placeholder: 'Confirm',  type: 'password', autocomplete: 'off', class: 'form-control b' 

  / = f.input :email, autofocus: true, required: true

  / - if show_all or resource.try(:first_name).present? or resource.try(:last_name).present?
  /   = f.input :first_name
  /   = f.input :last_name

  / - if resource.new_record?
  /   - unless hide_password
  /     %div{class: resource.errors.empty? ? 'collapse fade' : ''}
  /       = f.input :password, required: true, autocomplete: 'off'

  / - else # updating resource
  /   = f.input :password, autocomplete: 'off'
  /   - if resource.password_required?
  /     = f.input :current_password, autocomplete: 'off'

  = f.button :submit, class: 'btn-primary'
  - login_link = link_to I18n.t('auth.login.link'), new_user_session_path
  %h5.title= I18n.t('auth.signup.help', login_link: login_link).html_safe
